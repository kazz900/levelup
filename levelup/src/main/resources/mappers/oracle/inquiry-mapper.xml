<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="inquiryMapper">

	<resultMap id="resultInquiry" type="Inquiry">
		<id property="inquiryId" column="INQUIRY_ID" />
		<result property="userId" column="USERID" />
		<result property="employeeId" column="EMPLOYEE_ID" />
		<result property="inquiryTitle" column="INQUIRY_TITLE" />
		<result property="inquiryContent" column="INQUIRY_CONTENT" />
		<result property="answerStatus" column="ANSWER_STATUS" />
		<result property="editDate" column="EDIT_DATE" />
		<result property="answerDate" column="ANSWER_DATE" />
		<result property="answerContent" column="ANSWER_CONTENT" />
		<result property="attachmentFileName"
			column="ATTACHEMENT_FILENAME" />
		<result property="inquiryType" column="INQUIRY_TYPE" />
		<result property="inquiryRef" column="INQUIRY_REF" />
		<result property="answerRef" column="ASNWER_REF" />
	</resultMap>

	<resultMap id="resultList" type="Inquiry">
		<result property="inquiryId" column="INQUIRY_ID" />
		<result property="userId" column="USERID" />
		<result property="employeeId" column="EMPLOYEE_ID" />
		<result property="inquiryTitle" column="INQUIRY_TITLE" />
		<result property="inquiryContent" column="INQUIRY_CONTENT" />
		<result property="answerStatus" column="ANSWER_STATUS" />
		<result property="editDate" column="EDIT_DATE" />
		<result property="answerDate" column="ANSWER_DATE" />
		<result property="answerContent" column="ANSWER_CONTENT" />
		<result property="attachmentFileName"
			column="ATTACHEMENT_FILENAME" />
		<result property="inquiryType" column="INQUIRY_TYPE" />
		<result property="inquiryRef" column="INQUIRY_REF" />
		<result property="answerRef" column="ASNWER_REF" />
	</resultMap>

	<select id="selectList" parameterType="Paging"
		resultMap="resultInquiry">
		<![CDATA[
		select * 
		from (select rownum rnum, INQUIRY_ID, USERID, EMPLOYEE_ID, 
				   INQUIRY_TITLE, INQUIRY_CONTENT, ANSWER_STATUS, 
		           EDIT_DATE, ANSWER_DATE, ANSWER_CONTENT, ATTACHEMENT_FILENAME, 
		           INQUIRY_TYPE, INQUIRY_REF, ASNWER_REF
		      from (select * from INQUIRY 
		           order by EDIT_DATE desc)) 
		where rnum >= #{ startRow } and rnum <= #{ endRow }
		]]>
	</select>

	<select id="selectListCount" resultType="_int">
		select count(*) from
		INQUIRY
	</select>

	<select id="selectSearchUserIDCount" parameterType="string" resultType="_int">
		select count(*) from inquiry
		where USERID like '%' || #{ keyword } || '%'
	</select>
	
	<select id="selectSearchUserID" parameterType="Search" resultMap="resultList">
		select *
		from (select rownum rnum, INQUIRY_ID, USERID, EMPLOYEE_ID, INQUIRY_TITLE, INQUIRY_CONTENT, 
				  ANSWER_STATUS, EDIT_DATE, ANSWER_DATE, ANSWER_CONTENT, ATTACHEMENT_FILENAME, INQUIRY_TYPE,
				  INQUIRY_REF, ASNWER_REF
			from (select * from INQUIRY 
				 where USERID like '%' || #{ keyword } || '%'
				 order by EDIT_DATE DESC))
		where rnum between #{ startRow } and #{ endRow }
	</select>

	<insert id="insertInquiry" parameterType="Inquiry">
		insert into inquiry
		(INQUIRY_ID, USERID, INQUIRY_TITLE, INQUIRY_CONTENT, ANSWER_STATUS,
		EDIT_DATE, INQUIRY_TYPE)
		VALUES (default, #{userId}, #{inquiryTitle},
		#{inquiryContent}, #{answerStatus}, sysdate, #{inquiryType})
	</insert>
</mapper>